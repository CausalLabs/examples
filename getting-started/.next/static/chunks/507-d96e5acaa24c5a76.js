(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[507],{4098:function(e,t){var r="undefined"!==typeof self?self:this,n=function(){function e(){this.fetch=!1,this.DOMException=r.DOMException}return e.prototype=r,new e}();!function(e){!function(t){var r="URLSearchParams"in e,n="Symbol"in e&&"iterator"in Symbol,i="FileReader"in e&&"Blob"in e&&function(){try{return new Blob,!0}catch(e){return!1}}(),o="FormData"in e,s="ArrayBuffer"in e;if(s)var a=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],u=ArrayBuffer.isView||function(e){return e&&a.indexOf(Object.prototype.toString.call(e))>-1};function c(e){if("string"!==typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(e))throw new TypeError("Invalid character in header field name");return e.toLowerCase()}function l(e){return"string"!==typeof e&&(e=String(e)),e}function f(e){var t={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return n&&(t[Symbol.iterator]=function(){return t}),t}function d(e){this.map={},e instanceof d?e.forEach((function(e,t){this.append(t,e)}),this):Array.isArray(e)?e.forEach((function(e){this.append(e[0],e[1])}),this):e&&Object.getOwnPropertyNames(e).forEach((function(t){this.append(t,e[t])}),this)}function h(e){if(e.bodyUsed)return Promise.reject(new TypeError("Already read"));e.bodyUsed=!0}function v(e){return new Promise((function(t,r){e.onload=function(){t(e.result)},e.onerror=function(){r(e.error)}}))}function p(e){var t=new FileReader,r=v(t);return t.readAsArrayBuffer(e),r}function y(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function g(){return this.bodyUsed=!1,this._initBody=function(e){var t;this._bodyInit=e,e?"string"===typeof e?this._bodyText=e:i&&Blob.prototype.isPrototypeOf(e)?this._bodyBlob=e:o&&FormData.prototype.isPrototypeOf(e)?this._bodyFormData=e:r&&URLSearchParams.prototype.isPrototypeOf(e)?this._bodyText=e.toString():s&&i&&((t=e)&&DataView.prototype.isPrototypeOf(t))?(this._bodyArrayBuffer=y(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):s&&(ArrayBuffer.prototype.isPrototypeOf(e)||u(e))?this._bodyArrayBuffer=y(e):this._bodyText=e=Object.prototype.toString.call(e):this._bodyText="",this.headers.get("content-type")||("string"===typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):r&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},i&&(this.blob=function(){var e=h(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?h(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(p)}),this.text=function(){var e=h(this);if(e)return e;if(this._bodyBlob)return function(e){var t=new FileReader,r=v(t);return t.readAsText(e),r}(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(function(e){for(var t=new Uint8Array(e),r=new Array(t.length),n=0;n<t.length;n++)r[n]=String.fromCharCode(t[n]);return r.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},o&&(this.formData=function(){return this.text().then(w)}),this.json=function(){return this.text().then(JSON.parse)},this}d.prototype.append=function(e,t){e=c(e),t=l(t);var r=this.map[e];this.map[e]=r?r+", "+t:t},d.prototype.delete=function(e){delete this.map[c(e)]},d.prototype.get=function(e){return e=c(e),this.has(e)?this.map[e]:null},d.prototype.has=function(e){return this.map.hasOwnProperty(c(e))},d.prototype.set=function(e,t){this.map[c(e)]=l(t)},d.prototype.forEach=function(e,t){for(var r in this.map)this.map.hasOwnProperty(r)&&e.call(t,this.map[r],r,this)},d.prototype.keys=function(){var e=[];return this.forEach((function(t,r){e.push(r)})),f(e)},d.prototype.values=function(){var e=[];return this.forEach((function(t){e.push(t)})),f(e)},d.prototype.entries=function(){var e=[];return this.forEach((function(t,r){e.push([r,t])})),f(e)},n&&(d.prototype[Symbol.iterator]=d.prototype.entries);var m=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function b(e,t){var r=(t=t||{}).body;if(e instanceof b){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new d(e.headers)),this.method=e.method,this.mode=e.mode,this.signal=e.signal,r||null==e._bodyInit||(r=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=t.credentials||this.credentials||"same-origin",!t.headers&&this.headers||(this.headers=new d(t.headers)),this.method=function(e){var t=e.toUpperCase();return m.indexOf(t)>-1?t:e}(t.method||this.method||"GET"),this.mode=t.mode||this.mode||null,this.signal=t.signal||this.signal,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&r)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(r)}function w(e){var t=new FormData;return e.trim().split("&").forEach((function(e){if(e){var r=e.split("="),n=r.shift().replace(/\+/g," "),i=r.join("=").replace(/\+/g," ");t.append(decodeURIComponent(n),decodeURIComponent(i))}})),t}function S(e){var t=new d;return e.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach((function(e){var r=e.split(":"),n=r.shift().trim();if(n){var i=r.join(":").trim();t.append(n,i)}})),t}function _(e,t){t||(t={}),this.type="default",this.status=void 0===t.status?200:t.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in t?t.statusText:"OK",this.headers=new d(t.headers),this.url=t.url||"",this._initBody(e)}b.prototype.clone=function(){return new b(this,{body:this._bodyInit})},g.call(b.prototype),g.call(_.prototype),_.prototype.clone=function(){return new _(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new d(this.headers),url:this.url})},_.error=function(){var e=new _(null,{status:0,statusText:""});return e.type="error",e};var A=[301,302,303,307,308];_.redirect=function(e,t){if(-1===A.indexOf(t))throw new RangeError("Invalid status code");return new _(null,{status:t,headers:{location:e}})},t.DOMException=e.DOMException;try{new t.DOMException}catch(O){t.DOMException=function(e,t){this.message=e,this.name=t;var r=Error(e);this.stack=r.stack},t.DOMException.prototype=Object.create(Error.prototype),t.DOMException.prototype.constructor=t.DOMException}function x(e,r){return new Promise((function(n,o){var s=new b(e,r);if(s.signal&&s.signal.aborted)return o(new t.DOMException("Aborted","AbortError"));var a=new XMLHttpRequest;function u(){a.abort()}a.onload=function(){var e={status:a.status,statusText:a.statusText,headers:S(a.getAllResponseHeaders()||"")};e.url="responseURL"in a?a.responseURL:e.headers.get("X-Request-URL");var t="response"in a?a.response:a.responseText;n(new _(t,e))},a.onerror=function(){o(new TypeError("Network request failed"))},a.ontimeout=function(){o(new TypeError("Network request failed"))},a.onabort=function(){o(new t.DOMException("Aborted","AbortError"))},a.open(s.method,s.url,!0),"include"===s.credentials?a.withCredentials=!0:"omit"===s.credentials&&(a.withCredentials=!1),"responseType"in a&&i&&(a.responseType="blob"),s.headers.forEach((function(e,t){a.setRequestHeader(t,e)})),s.signal&&(s.signal.addEventListener("abort",u),a.onreadystatechange=function(){4===a.readyState&&s.signal.removeEventListener("abort",u)}),a.send("undefined"===typeof s._bodyInit?null:s._bodyInit)}))}x.polyfill=!0,e.fetch||(e.fetch=x,e.Headers=d,e.Request=b,e.Response=_),t.Headers=d,t.Request=b,t.Response=_,t.fetch=x,Object.defineProperty(t,"__esModule",{value:!0})}({})}(n),n.fetch.ponyfill=!0,delete n.fetch.polyfill;var i=n;(t=i.fetch).default=i.fetch,t.fetch=i.fetch,t.Headers=i.Headers,t.Request=i.Request,t.Response=i.Response,e.exports=t},9921:function(e,t,r){"use strict";r.d(t,{B3:function(){return Pe},H_:function(){return Re},N$:function(){return G},br:function(){return T},kB:function(){return Oe},on:function(){return Ue},z_:function(){return M}});var n=r(4051),i=r.n(n),o=r(4098),s=r.n(o),a=r(7294),u=r(3454);function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function l(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function f(e,t,r,n,i,o,s){try{var a=e[o](s),u=a.value}catch(c){return void r(c)}a.done?t(u):Promise.resolve(u).then(n,i)}function d(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function s(e){f(o,n,i,s,a,"next",e)}function a(e){f(o,n,i,s,a,"throw",e)}s(void 0)}))}}function h(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function v(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function p(e,t,r){return t&&v(e.prototype,t),r&&v(e,r),e}function y(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function g(e){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function m(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&A(e,t)}function b(e,t){return null!=t&&"undefined"!==typeof Symbol&&t[Symbol.hasInstance]?!!t[Symbol.hasInstance](e):e instanceof t}function w(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){y(e,t,r[t])}))}return e}function S(e,t){if(null==e)return{};var r,n,i=function(e,t){if(null==e)return{};var r,n,i={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(i[r]=e[r]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function _(e,t){return!t||"object"!==R(t)&&"function"!==typeof t?l(e):t}function A(e,t){return(A=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function x(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,i,o=[],s=!0,a=!1;try{for(r=r.call(e);!(s=(n=r.next()).done)&&(o.push(n.value),!t||o.length!==t);s=!0);}catch(u){a=!0,i=u}finally{try{s||null==r.return||r.return()}finally{if(a)throw i}}return o}}(e,t)||E(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function O(e){return function(e){if(Array.isArray(e))return c(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||E(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var R=function(e){return e&&"undefined"!==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e};function E(e,t){if(e){if("string"===typeof e)return c(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(r):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?c(e,t):void 0}}function I(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=g(e);if(t){var i=g(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return _(this,r)}}var k=function e(){h(this,e),this._={}},T=function(e){m(r,e);var t=I(r);function r(){var e;return h(this,r),(e=t.apply(this,arguments)).product="",e.callToAction="Rate this product!",e}return r.prototype.signalRating=function(e){e.stars;J(this,"Rating",arguments[0])},r.signalRating=function(e,t,r){r.stars;L("RatingBox","Rating",Array.prototype.slice.call(arguments))},r}(k),C=function(e){m(r,e);var t=I(r);function r(){return h(this,r),t.apply(this,arguments)}return r}(k),j=function(e){m(r,e);var t=I(r);function r(){var e;return h(this,r),(e=t.apply(this,arguments)).exampleArg="",e.exampleOutput="Example output",e}return r.prototype.signalExampleEvent=function(e){e.data;J(this,"ExampleEvent",arguments[0])},r.signalExampleEvent=function(e,t,r){r.data;L("Feature2","ExampleEvent",Array.prototype.slice.call(arguments))},r}(k),F={RatingBox:T,ProductInfo:C,Feature2:j},B=function e(t){h(this,e),this._={sessionKeys:t}};function D(e){return{deviceId:null===e||void 0===e?void 0:e.deviceId}}function N(e){var t;return{"X-Causal-deviceId":null!==(t=null===e||void 0===e?void 0:e.deviceId)&&void 0!==t?t:"null"}}var P=function(){function e(){h(this,e),this._={wireArgs:{}},V(this)}var t=e.prototype;return t.getRatingBox=function(e){e.product;return this},t.getProductInfo=function(){return this},t.getFeature2=function(e){e.exampleArg;return this},e}(),U={RatingBox:!0,ProductInfo:!0,Feature2:!0},M=function(e){m(r,e);var t=I(r);function r(e,n){var i;h(this,r),i=t.call(this,D(e));var o=function(e,t){switch(e){case"none":return new te;case"inMemory":return new ne}var r=void 0;switch(e){case"localStorage":r=new re;break;case"custom":case"customLocalStorage":r=(null!==t&&void 0!==t?t:function(){return ge.warn("no makeCustomStore"),new te})();break;default:ge.error("unknown cache type");r=new te}if(r.dontStore())return r;var n="_causal_storage_test",i="tests if storage works",o=!1;try{r.set(n,i);var s=r.get(n);r.del(n),s==i&&(o=!0)}catch(a){}return o?r:(ge.warn('The requested storage "'.concat(e,'" did not work. Falling back to in-memory store')),new ne)}(be.ssr?Se.ssrCacheType:Se.csrCacheType,Se.makeCustomStore),s=new fe(e,o,Se);return i._={args:e,cache:s,implicitArgs:{},originator:be.ssr?"ssr":"csr",hydrating:!1,hydrationKeys:[],loadingImpressionsCount:0,commSnapshot:{fetches:0,featuresReceived:0,featuresRequested:0,errorsReceived:0,errorsAndWarnings:[]},sessionKeys:D(e)},n&&i.addIncomingMessageArgs(n),i._.cache.testAndTouchSession(),V(l(i)),i}var n=r.prototype;return n.args=function(){return w({},this._.args)},n.keepAlive=function(){return Date.now()-r.lastKeepAlive>1e3&&(r.lastKeepAlive=Date.now(),xe.sendBeacon(N(D(this._.args)),{id:this._.args}),!0)},n.commSnapshot=function(){return this._.commSnapshot},n.toJSON=function(){0==this._.commSnapshot.fetches&&ge.warn("Session.toJSON() called before a call to requestImpression() or requestCacheFill()");var e={},t=[],r=!0,n=!1,i=void 0;try{for(var o,s=this._.cache.backingStore.keys()[Symbol.iterator]();!(r=(o=s.next()).done);r=!0){var a=o.value;if(a.startsWith(le)){var u=a.substring(le.length);if(u!=oe){var c=this._.cache.backingStore.get(a);e[u]=c}}else{var l=a,f=this._.cache.backingStore.get(l);if(f){var d=!0,h=!1,v=void 0;try{for(var p,y=Object.entries(f)[Symbol.iterator]();!(d=(p=y.next()).done);d=!0){var g=x(p.value,2),m=g[0],b=w({},g[1],{featureName:l,args:m});t.push(b)}}catch(_){h=!0,v=_}finally{try{d||null==y.return||y.return()}finally{if(h)throw v}}}}}}catch(_){n=!0,i=_}finally{try{r||null==s.return||s.return()}finally{if(n)throw i}}var S={sessionArgs:this._.args,cacheJson:e,featureJson:t,commSnapshotJson:this.commSnapshot(),originator:this._.originator,activeVariants:this.activeVariants};return JSON.parse(JSON.stringify(S))},n.setHydrationComplete=function(){if(this._.hydrating){var e=this._.hydrationKeys,t=!0,r=!1,n=void 0;try{for(var i,o=e[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var s=i.value,a=this._.cache.getFeature(s.featureName,s.args);a&&this._.cache.setFeature(s.featureName,s.args,w({},a,{hydratable:!1}))}}catch(u){r=!0,n=u}finally{try{t||null==o.return||o.return()}finally{if(r)throw n}}this._.hydrating=!1,this._.hydrationKeys=[]}},n.addIncomingMessageArgs=function(e){this._.implicitArgs=w({},this._.args,{userAgent:null===e||void 0===e?void 0:e.headers["user-agent"],clientType:"typescript",ipAddress:null===e||void 0===e?void 0:e.socket.remoteAddress,entryUrl:null===e||void 0===e?void 0:e.url})},n.requestImpression=function(e,t){var r=this;return d(i().mark((function n(){return i().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return void 0==t&&(t=Y()),n.next=3,W(r,e,t);case 3:return n.abrupt("return",n.sent);case 4:case"end":return n.stop()}}),n)})))()},n.requestCacheFill=function(e){var t=this;return d(i().mark((function r(){return i().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,W(t,e,void 0);case 2:case"end":return r.stop()}}),r)})))()},n.clearImpressionStats=function(){this._.loadingImpressionsCount=0,this._.cache.clearCacheStats()},n.getImpressionStats=function(){var e=this._.cache.cacheStats,t=O(e.hits.keys()),r=O(e.misses.keys()),n=this._.loadingImpressionsCount;return{cacheHits:t,cacheMisses:r,cacheNoOps:this._.cache.backingStore.keys().filter((function(t){return!t.startsWith(le)&&"session"!=t&&void 0==e.hits.get(t)&&void 0==e.misses.get(t)})),loadingImpressions:n}},r.fromDeviceId=function(e,t){return new r({deviceId:e},t)},r.fromJSON=function(e,t){var n=w({},{alwaysDelExistingCache:!1,hydrating:"ssr"==e.originator&&!be.ssr},t),i=new r(e.sessionArgs);i._.originator=e.originator,n.alwaysDelExistingCache&&i._.cache.backingStore.delAll();var o=n.hydrating,s=e.cacheJson,a=e.featureJson;if(void 0!=s){var u=!0,c=!1,l=void 0;try{for(var f,d=Object.entries(s)[Symbol.iterator]();!(u=(f=d.next()).done);u=!0){var h=x(f.value,2),v=h[0],p=h[1];if(p)try{i._.cache.set(v,p)}catch(F){ge.warn("failed to restore non feature "+v)}}}catch(B){c=!0,l=B}finally{try{u||null==d.return||d.return()}finally{if(c)throw l}}}if(i._.cache.set("transferredCommSnapshot",e.commSnapshotJson),void 0!=a){var y=!0,g=!1,m=void 0;try{for(var b,_=a[Symbol.iterator]();!(y=(b=_.next()).done);y=!0){var A=b.value,O=A.featureName,R=A.args,E=S(A,["featureName","args"]);try{var I=E.created,k=E.expires,T=S(E,["created","expires"]),C=new Date(I),j=new Date(k);i._.cache.setFeature(O,R,w({},T,{created:C,expires:j,hydratable:o}))}catch(F){ge.warn("failed to restore feature entry ".concat(O," ").concat(R))}}}catch(B){g=!0,m=B}finally{try{y||null==_.return||_.return()}finally{if(g)throw m}}i._.hydrating=o,i._.hydrationKeys=o?a.map((function(e){return{featureName:e.featureName,args:e.args}})):[]}return i},p(r,[{key:"activeVariants",get:function(){var e;return null!==(e=this._.cache.get(ae))&&void 0!==e?e:[]}},{key:"requestedFeatures",get:function(){var e;return null!==(e=this._.cache.get(ue))&&void 0!==e?e:[]}}]),r}(B);function J(e,t,r){void 0!=e._.impression&&void 0!=e._.impressionId&&q(e.featureName,t,e._.impression.sessionKeys,e._.impressionId,r)}function L(e,t,r){var n=r[0];q(e,t,b(n,M)?D(n.args()):D(n),r[1],r[2])}function q(e,t,r,n,i){var o={id:r,feature:e,event:t,impressionId:n,args:i};xe.sendBeacon(N(r),o)}M.lastKeepAlive=0;var K=function(e){m(r,e);var t=I(r);function r(e){var n;h(this,r),(n=t.call(this,e.sessionKeys))._={json:e,sessionKeys:e.sessionKeys};var i=e.wireOutputs,o=e.wireArgs,s=!0,a=!1,u=void 0;try{for(var c,f=function(t,r){var s=r.value;if("Session"==s||"session"==s)return"continue";var a=i[s],u=void 0;switch(e.impressionType){case"error":u=U[s];break;case"loading":u=!1;break;case"real":u="OFF"!=a,void 0==a&&(ge.info("undefined or null output for "+s+". Using defaults."),u=U[s])}if(u){var c=new(0,F[s]);c.featureName=s,V(c);var f=i[s],d=o[s],h=null===f||void 0===f?void 0:f._impressionId;if(f&&(c._.impression=l(n),c._.impressionId=h),"function"==typeof Proxy){var v={get:function(e,t,r){return t.startsWith("signal")?Reflect.get(e,t,r):void 0!==(null===d||void 0===d?void 0:d[t])?d[t]:void 0!==(null===f||void 0===f?void 0:f[t])?null!==(n=f[t])&&void 0!==n?n:void 0:Reflect.get(e,t,r);var n}};n[s]=new Proxy(c,v)}}},d=Object.keys(null!==o&&void 0!==o?o:{})[Symbol.iterator]();!(s=(c=d.next()).done);s=!0)f(0,c)}catch(v){a=!0,u=v}finally{try{s||null==d.return||d.return()}finally{if(a)throw u}}return V(l(n)),n}return r.prototype.toJSON=function(){return this._.json},p(r,[{key:"sessionKeys",get:function(){return this._.json.sessionKeys}}]),r}(B);function V(e){Object.getOwnPropertyNames(Object.getPrototypeOf(e)).filter((function(t){return"function"===typeof e[t]})).filter((function(e){return"constructor"!=e})).forEach((function(t){return e[t]=e[t].bind(e)}))}function W(e,t,r){return H.apply(this,arguments)}function H(){return(H=d(i().mark((function e(t,r,n){var o,s,a,u,c,l,f,d,h,v,p,y,g,m,b,w;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=t._.cache,s=r._.wireArgs,a=Z(t,s),u=a.cachedImpression,c=a.cachedFlags,void 0==u||void 0==c){e.next=7;break}return l=u,void 0!=n&&(De(t,void 0,n,u),Be(t,u,n),l=Ne(u,n,s)),e.abrupt("return",{impression:l,flags:c});case 7:return f=[],e.next=10,Te({options:f,impressionId:n,sessionArgs:t._.args,implicitArgs:t._.implicitArgs,wireArgs:s});case 10:if(d=e.sent,h=d.flags,v=d.impression,p=d.error,y=d.warning,g=d.activeVariants,m=d.featuresRequested,b=d.featuresReceived,t._.commSnapshot.fetches+=1,t._.commSnapshot.featuresRequested+=m,t._.commSnapshot.featuresReceived+=b,p&&(t._.commSnapshot.errorsReceived+=1,t._.commSnapshot.errorsAndWarnings.unshift(p)),y&&(t._.commSnapshot.errorsReceived+=1,t._.commSnapshot.errorsAndWarnings.unshift(y)),t._.commSnapshot.errorsAndWarnings.splice(5),h&&o.setFlags(h),g&&De(t,g,n,v),void 0==v){e.next=31;break}return o.setOutputs(s,v.toJSON().wireOutputs,void 0==n),e.abrupt("return",{impression:v,flags:X(v),error:p});case 31:return w=Q(t,"Fetch Failure",{wireArgs:s}),e.abrupt("return",{impression:w,flags:X(w),error:null!==p&&void 0!==p?p:{errorType:"unknown",message:"unknown error"}});case 33:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function G(e){var t=(0,a.useRef)(e),r=(0,a.useRef)(void 0);return e==t.current&&void 0!=r.current||(r.current=M.fromJSON(e)),(0,a.useEffect)((function(){var e;null===(e=r.current)||void 0===e||e.setHydrationComplete()})),r.current}function z(e,t){return JSON.stringify(e,ve)==JSON.stringify(t,ve)}function X(e){if(void 0!=e){var t=e._.json.wireArgs,r=e._.json.wireOutputs,n={},i=!0,o=!1,s=void 0;try{for(var a,u=Object.keys(null!==t&&void 0!==t?t:{})[Symbol.iterator]();!(i=(a=u.next()).done);i=!0){var c=a.value,l=r[c],f=c;n[f]=void 0===l?U[f]:"OFF"!=l}}catch(d){o=!0,s=d}finally{try{i||null==u.return||u.return()}finally{if(o)throw s}}return n}}function Z(e,t){var r=e._.cache.outputs(t);if(void 0==r)return{metadata:new Map};var n=r.wireOutputs,i=r.metadata,o=Ee({impressionType:"real",wireArgs:t,sessionKeys:D(e._.args),wireOutputs:n});return{cachedImpression:o,cachedFlags:X(o),metadata:i}}function $(e){return new K({impressionType:"loading",sessionKeys:D(e._.args),wireArgs:{},wireOutputs:{}})}function Q(e,t,r){var n=r.wireArgs;return new K({sessionKeys:e?D(e._.args):{},impressionType:"error",reason:t,wireArgs:Ie(n),wireOutputs:{}})}function Y(){for(var e="",t=0;e.length<32&&t<100;t++)e+=(4294967295*Math.random()).toString(16).split(".")[0];if(100==t)throw new Error("FATAL: failed to generate uuid");return e.slice(0,8)+"-"+e.slice(8,12)+"-"+e.slice(12,16)+"-"+e.slice(16,20)+"-"+e.slice(20,32)}var ee=0,te=function(){function e(){h(this,e)}var t=e.prototype;return t.get=function(){},t.set=function(){},t.del=function(){},t.delAll=function(){},t.isEmpty=function(){return!0},t.keys=function(){return[]},t.dontStore=function(){return!0},e}(),re=function(){function e(){h(this,e)}var t=e.prototype;return t.get=function(t){var r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=r?e.makeKey(t):t,i=window.localStorage.getItem(n);if(i)try{var o=JSON.parse(i);return o}catch(s){return ge.warn("failed to deserialize from cache. Error = "+JSON.stringify(s)),void window.localStorage.removeItem(n)}},t.set=function(t,r){var n=e.makeKey(t);return window.localStorage.setItem(n,JSON.stringify(r))},t.del=function(t){var r=e.makeKey(t);window.localStorage.removeItem(r)},t.delAll=function(t){for(var r=localStorage.length-1;r>=0;--r){var n=localStorage.key(r);if((null===n||void 0===n?void 0:n.startsWith(e.prefix))&&n!=ce){var i=this.get(n,!1);(void 0==t||void 0==i||t(i))&&localStorage.removeItem(n)}}},t.isEmpty=function(){for(var t=0;t<localStorage.length;t++){var r=localStorage.key(t);if(null===r||void 0===r?void 0:r.startsWith(e.prefix))return!1}return!0},t.keys=function(){for(var t=[],r=e.prefix.length,n=0;n<localStorage.length;n++){var i=localStorage.key(n);(null===i||void 0===i?void 0:i.startsWith(e.prefix))&&t.push(i.substring(r))}return t},t.dontStore=function(){return!1},e.makeKey=function(t){return e.prefix+t},e}();re.prefix="_causal_";var ne=function(){function e(){h(this,e),this.map=new Map}var t=e.prototype;return t.get=function(e){var t=this.map.get(e);if(void 0!=t)return JSON.parse(t)},t.set=function(e,t){var r=JSON.stringify(t);return this.map.set(e,r)},t.del=function(e){return this.map.delete(e)},t.delAll=function(e){if(void 0==e)this.map=new Map;else{var t=!0,r=!1,n=void 0;try{for(var i,o=this.keys()[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var s=i.value,a=this.get(s);(void 0==a||e(a))&&this.del(s)}}catch(u){r=!0,n=u}finally{try{t||null==o.return||o.return()}finally{if(r)throw n}}}},t.isEmpty=function(){return 0==this.map.size},t.keys=function(){return O(this.map.keys())},t.dontStore=function(){return!1},e}(),ie="sseInfo",oe="cacheInfo",se="flags",ae="activeVariants",ue="activeFeatures",ce="_causal_registered",le="_",fe=function(){function e(t,r,n){h(this,e),this.cacheStats={hits:new Map,misses:new Map};var i=n.outputExpirySeconds,o=n.useServerSentEvents,s=n.sessionCacheExpirySeconds;if(this.backingStore=r,this.outputExpirySeconds=i,this.useServerSentEvents=o,this.sessionCacheExpirySeconds=s,this.sessionArgs=t,void 0!=t&&(this.eventSource=void 0,void 0!=t&&!be.ssr&&!this.backingStore.dontStore()&&this.useServerSentEvents)){if(!xe.newEvtSource)throw new Error("fatal: can not register server sent events");var a=function(e){var t=xe.getBaseUrl().replace(/\/?$/,"/sse?id=");return void 0!=e.deviceId&&(t+=e.deviceId+"+"),t}(t);this.eventSource=xe.newEvtSource(a),this.eventSource.addEventListener("flushcache",this.sseFlushCache.bind(this)),this.eventSource.addEventListener("flushfeatures",this.sseFlushFeatures.bind(this)),this.eventSource.addEventListener("hello",this.sseHello.bind(this))}}var t=e.prototype;return t.get=function(e){return this.backingStore.get(le+e)},t.set=function(e,t){this.backingStore.set(le+e,t)},t.getFeature=function(e,t){var r=this.backingStore.get(e);if(void 0!=r){var n=r[pe(t)];if(void 0!=n){var i=n.created,o=n.expires,s=S(n,["created","expires"]),a=new Date,u=new Date(i),c=new Date(o);if(!(c<a))return w({},s,{created:u,expires:c});this.backingStore.del(e)}}},t.getFeatures=function(e){var t=this.backingStore.get(e),r=[],n=!0,i=!1,o=void 0;try{for(var s,a=Object.entries(t)[Symbol.iterator]();!(n=(s=a.next()).done);n=!0){var u=x(s.value,2),c=u[0],l=u[1],f=JSON.parse(c),d=new Date(l.created),h=new Date(l.expires);r.push(w({},l,{args:f,created:d,expires:h}))}}catch(v){i=!0,o=v}finally{try{n||null==a.return||a.return()}finally{if(i)throw o}}return r},t.setFeature=function(e,t,r){var n=this.backingStore.get(e);if(void 0==n){if(void 0==r)return;n={}}var i=pe(t);if(void 0==r)return delete n[i],void this.backingStore.set(e,n);var o=r.expires,s=r.created,a=r.origRender,u=r.lastRender,c=r.impressionCount,l=r.hydratable,f=S(r,["expires","created","origRender","lastRender","impressionCount","hydratable"]),d=(null!==s&&void 0!==s?s:new Date).toISOString(),h=o.toISOString(),v=null!==a&&void 0!==a?a:be.ssr?"ssr":"csr",p=w({},f,{created:d,expires:h,origRender:v,lastRender:null!==u&&void 0!==u?u:v,impressionCount:null!==c&&void 0!==c?c:1,hydratable:null!==l&&void 0!==l&&l});return n[i]=p,this.backingStore.set(e,n)},t.deleteAll=function(e){void 0!=this.sessionArgs&&(this.backingStore.delAll(),e&&(ee+=1))},t.testAndTouchSession=function(){if(ge.debug(5,"testAndTouchSession"),this.backingStore.dontStore())return!1;var e=this.get(oe),t=new Date,r=!1,n=!1;if(e){try{var i=Je(new Date(e.lastAccess),this.sessionCacheExpirySeconds);n=isNaN(i.valueOf()),(void 0==e.version||e.version<1||i<t||n)&&(r=!0)}catch(u){r=!0,n=!0}if(r){ge.debug(1,"session expired"),r=!0;var o=!n;this.deleteAll(o)}}var s=this.sessionArgs;this.backingStore.isEmpty()||!(null===e||void 0===e?void 0:e.sessionArgs)||z(e.sessionArgs,s)||(ge.debug(1,"session args changes, deleting values"),this.deleteAll(!0));var a={sessionStart:r||!e?t.toISOString():e.sessionStart,lastAccess:t.toISOString(),sessionArgs:this.sessionArgs,version:1};return this.set(oe,a),!0},t.getOutputExpiry=function(){return void 0==this.outputExpirySeconds?Me:(e=this.outputExpirySeconds,new Date(Date.now()+1e3*e));var e},t.flags=function(){if(this.testAndTouchSession()){var e=this.get(se);if(void 0!=e)return e}},t.setFlags=function(e){this.testAndTouchSession()&&this.set(se,e)},t.addCacheHit=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=!0,i=!1,o=void 0;try{for(var s,a=t[Symbol.iterator]();!(n=(s=a.next()).done);n=!0){var u,c=s.value,l=null!==(u=this.cacheStats.hits.get(c))&&void 0!==u?u:0;this.cacheStats.hits.set(c,l+1)}}catch(f){i=!0,o=f}finally{try{n||null==a.return||a.return()}finally{if(i)throw o}}},t.addCacheMiss=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=!0,i=!1,o=void 0;try{for(var s,a=t[Symbol.iterator]();!(n=(s=a.next()).done);n=!0){var u,c=s.value,l=null!==(u=this.cacheStats.misses.get(c))&&void 0!==u?u:0;this.cacheStats.misses.set(c,l+1)}}catch(f){i=!0,o=f}finally{try{n||null==a.return||a.return()}finally{if(i)throw o}}},t.clearCacheStats=function(){this.cacheStats={hits:new Map,misses:new Map}},t.outputs=function(e){if(this.testAndTouchSession()){var t={},r=new Map,n=!0,i=this.getFeature("session",this.sessionArgs);if(void 0==i)n=!1,this.addCacheMiss("session"),this.addCacheMiss.apply(this,O(Object.keys(null!==e&&void 0!==e?e:{})));else{t.session=i.value;var o=!0,s=!1,a=void 0;try{for(var u,c=Object.entries(e)[Symbol.iterator]();!(o=(u=c.next()).done);o=!0){var l=x(u.value,2),f=l[0],d=l[1],h=this.getFeature(f,d);if(void 0==h){n=!1,this.addCacheMiss(f);break}try{t[f]=h.value;var v=pe(d),p="".concat(f,".").concat(v);r.set(p,{origRender:h.origRender,lastRender:h.lastRender,impressionCount:h.impressionCount,hydratable:h.hydratable}),this.addCacheHit(f)}catch(y){ge.warn("unexpected exception retrieving from cache"),n=!1;break}}}catch(g){s=!0,a=g}finally{try{o||null==c.return||c.return()}finally{if(s)throw a}}}return n?{wireOutputs:t,metadata:r}:void 0}},t.setOutputs=function(e,t,r){if(this.testAndTouchSession()){var n=this.getOutputExpiry(),i=!0,o=!1,s=void 0;try{for(var a,u=Object.entries(t)[Symbol.iterator]();!(i=(a=u.next()).done);i=!0){var c=x(a.value,2),l=c[0],f=c[1];if("session"==l)this.setFeature(l,this.sessionArgs,{value:f,expires:n});else{var d=e[l];void 0!=d&&(l.startsWith(le)||this.setFeature(l,d,{value:f,expires:n,impressionCount:r?0:1}))}}}catch(h){o=!0,s=h}finally{try{i||null==u.return||u.return()}finally{if(o)throw s}}}},t.sseMaybeDel=function(e,t){if(!this.backingStore.dontStore())if(t)try{var r=new Date(t),n=this.getFeatures(e);if(void 0==n)return;var i=!0,o=!1,s=void 0;try{for(var a,u=n[Symbol.iterator]();!(i=(a=u.next()).done);i=!0){var c=a.value;c.created<r&&this.setFeature(e,c.args,void 0)}}catch(l){o=!0,s=l}finally{try{i||null==u.return||u.return()}finally{if(o)throw s}}}catch(f){ge.warn("unexpected error analyzing cache - deleting entry. error was "+JSON.stringify(f)),this.backingStore.del(e)}else this.backingStore.del(e)},t.sseFlushCache=function(e){if(!this.backingStore.dontStore()){var t=e;ee++,this.deleteAll(!1),this.set(ie,t.data)}},t.sseFlushFeatures=function(e){if(!this.backingStore.dontStore()){var t=e;ee++,this.sseMaybeDel(t.data,null)}},t.sseHello=function(e){if(!this.backingStore.dontStore()){var t=e,r=this.get(ie);void 0!=r&&t.data!=r&&this.deleteAll(!0),this.set(ie,t.data)}},e}();function de(e){return e.endsWith("/")?e:e+"/"}var he="";function ve(e,t){return!b(t,Object)||b(t,Array)?t:Object.keys(t).sort().reduce((function(e,r){return e[r]=t[r],e}),{})}function pe(e){return"string"==typeof e?e:JSON.stringify(null!==e&&void 0!==e?e:{},ve)}var ye={info:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n;(n=console).log.apply(n,O(t))},warn:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n;(n=console).warn.apply(n,O(t))},error:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n;(n=console).error.apply(n,O(t))},debug:function(e,t){for(var r=arguments.length,n=new Array(r>2?r-2:0),i=2;i<r;i++)n[i-2]=arguments[i];var o;e<=-1&&(o=console).log.apply(o,[t].concat(O(n)))}},ge=w({},ye);var me=!1,be=w({},{ssr:me,logIServerDetails:!1,logIServerCommErrors:!0,onUpdateActiveVariants:function(){},onImpression:function(){}});var we={outputExpirySeconds:31536e5,useServerSentEvents:function(){try{var e,t;return null!==(t="true"==(null===(e=window.localStorage)||void 0===e?void 0:e.getItem(ce)))&&void 0!==t&&t}catch(r){return!1}}(),sessionCacheExpirySeconds:1800,ssrCacheType:"inMemory",csrCacheType:"localStorage",makeCustomStore:function(){return ge.warn("no custom store function"),new te}},Se=w({},we),_e=void 0,Ae={timeoutMs:1e3,sendBeacon:function(e,t){xe.fetch(xe.getBaseUrl()+"signal",{method:"POST",body:JSON.stringify(t),headers:e,keepalive:!0})},fetch:function(e,t){return ge.debug(2,"defaultFetch"),s()(e,t)},newEvtSource:"undefined"==typeof EventSource?void 0:function(e){return new EventSource(e)},getBaseUrl:function(){return null!==_e&&void 0!==_e?_e:_e=function(e){var t,r,n,i,o=void 0;return e?void 0==(o=u.env.CAUSAL_ISERVER)&&(ge.warn("SSR impression server environment variable not set, defaulting to 'http://localhost:3004/iserver'. Please set CAUSAL_ISERVER"),o="http://localhost:3004/iserver/"):void 0==(o=null!==(i=null!==(n=null!==(r=null!==(t="https://tools.causallabs.io/sandbox-iserver")?t:u.env.VAGRANT_CAUSAL_BROWSER_ISERVER)&&void 0!==r?r:u.env.REACT_APP_CAUSAL_BROWSER_ISERVER)&&void 0!==n?n:u.env.RAZZLE_CAUSAL_BROWSER_ISERVER)&&void 0!==i?i:u.env.CAUSAL_BROWSER_ISERVER)&&(ge.warn("Browser impression server environment variable not set, defaulting to http://localhost:3004/iserver Please set one of: NEXT_PUBLIC_CAUSAL_BROWSER_ISERVER, VAGRANT_CAUSAL_BROWSER_ISERVER, RAZZLE_CAUSAL_BROWSER_ISERVER, CAUSAL_BROWSER_ISERVER"),o="http://localhost:3004/iserver/"),o=de(o),be.ssr&&o!=he&&(ge.info("impression server url: ",o),he=o),o}(me)}},xe=w({},Ae);function Oe(){var e=new P;return"function"!=typeof Proxy?e:new Proxy(e,{get:function(e,t,r){if(t.startsWith("get")){var n=t.slice(3);return function(t){return e._.wireArgs[n]=null!==t&&void 0!==t?t:{},r}}return Reflect.get(e,t,r)}})}function Re(e){return Ee(e)}function Ee(e){var t=e.impressionType,r=e.sessionKeys,n=e.wireArgs,i=e.wireOutputs;return new K({impressionType:t,sessionKeys:r,wireArgs:n,wireOutputs:i})}function Ie(e){return void 0==e?{}:JSON.parse(JSON.stringify(e))}function ke(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];var i,o;be.logIServerCommErrors?(i=ge).warn.apply(i,[e].concat(O(r))):be.logIServerDetails&&(o=ge).info.apply(o,[e].concat(O(r)))}function Te(e){return Ce.apply(this,arguments)}function Ce(){return(Ce=d(i().mark((function e(t){var r,n,o,s,a,u,c,l,f,d,h,v,p,y,g,m,b,_,A,x,R,E,I,k,T,C,j,F,B,P,M,J,L,q,V,W,H,G,z,X,Z;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.options,n=t.impressionId,o=t.sessionArgs,s=t.implicitArgs,a=t.wireArgs,u=O(r),be.logIServerDetails&&ge.info("iserver fetch START ------"),e.prev=3,be.ssr&&void 0==s.ipAddress&&ge.warn("Looks like you are rendering server side (SSR), did you forget to pass incomingMessage? This message can also appear during a static build of a CSR page, in which case you can ignore it."),c=void 0,a=Ie(a),l=Object.keys(null!==a&&void 0!==a?a:{}).length,e.prev=8,f={fetchOptions:u,args:w({},o,s),impressionId:n,requests:a},d=N(o),h=xe.getBaseUrl()+"features",v={method:"POST",body:JSON.stringify(f),headers:d},be.logIServerDetails&&(ge.info("fetch from url:",h),ge.info("fetch with payload:",v)),e.next=16,xe.fetch(h,v);case 16:c=e.sent,be.logIServerDetails&&ge.info("fetch() result:",c),void 0==c&&("Received undefined or null fetch() result ",ke("Received undefined or null fetch() result ")),e.next=27;break;case 21:return e.prev=21,e.t0=e.catch(8),ke(p="fetch threw an exception: ",e.t0),y={errorType:"fetch",message:p},e.abrupt("return",{impression:void 0,flags:void 0,error:y,featuresRequested:l,featuresReceived:0});case 27:if(void 0!=c){e.next=33;break}return"fetch returned null",g={errorType:"fetchResponse",message:"fetch returned null"},e.abrupt("return",{impression:void 0,flags:void 0,error:g,featuresRequested:l,featuresReceived:0});case 33:if(200==c.status){e.next=43;break}if(m="Impression server non 200. Result = ".concat(c.status,"."),void 0==c.text||"function"!=typeof c.text){e.next=40;break}return e.next=38,c.text();case 38:b=e.sent,m+="  fetch text() response = ".concat(b,".");case 40:return ke(m),_={errorType:"fetchResponse",message:m},e.abrupt("return",{impression:void 0,flags:void 0,error:_,featuresReceived:0,featuresRequested:l});case 43:return e.prev=44,e.next=47,c.json();case 47:if(A=e.sent,be.logIServerDetails&&ge.info("fetch...json() response",A),void 0!=A&&0!=Object.keys(A).length){e.next=54;break}return ke(x=void 0==A?"Unexpected undefined or null response callling fetch...json()":"Response was defined calling fetch...json(), but contained no data"),R={errorType:"fetchResponse",message:x},e.abrupt("return",{impression:void 0,flags:void 0,error:R,featuresRequested:l,featuresReceived:0});case 54:e.next=62;break;case 56:return e.prev=56,e.t1=e.catch(44),ke(E="exception thrown calling fetch...json()",e.t1),I={errorType:"fetch",message:E},e.abrupt("return",{impression:void 0,flags:void 0,error:I,featuresRequested:l,featuresReceived:0});case 62:return k=A._flags,T=A.errors,C=A._variants,j=S(A,["_flags","errors","_variants"]),F=new K({impressionType:"real",sessionKeys:D(j.session),wireArgs:a,wireOutputs:j}),B=void 0,P=void 0,M=k,L=(J=null!==j&&void 0!==j?j:{}).session,q=S(J,["session"]),V=Object.keys(null!==q&&void 0!==q?q:{}).length,l>0&&0==V&&(ke(W="no features were returned by the impression server"),P={errorType:"fetchResponse",message:W}),void 0==L?(ke(H="no session returned from impression server"),B={errorType:"fetchResponse",message:H}):(null===u||void 0===u?void 0:u.includes("flags"))&&void 0==k?(ke(G="unexpected empty response flags"),B={errorType:"fetchResponse",message:G},M=null!==M&&void 0!==M?M:U):void 0!=T&&(B={errorType:"field",message:"fetch succeeded, but one or more fields had an error",fieldErrors:T}),Fe(z=(null!==C&&void 0!==C?C:[]).map(je)),e.abrupt("return",{impression:F,flags:M,error:B,warning:P,activeVariants:z,featuresRequested:l,featuresReceived:V});case 76:return e.prev=76,e.t2=e.catch(3),ke(X="unexpected iserverFetch exception.",e.t2),Z={errorType:"fetch",message:X},e.abrupt("return",{impression:void 0,flags:void 0,error:Z,featuresRequested:0,featuresReceived:0});case 82:return e.prev=82,be.logIServerDetails&&ge.info("iserver fetch END ------"),e.finish(82);case 85:case"end":return e.stop()}}),e,null,[[3,76,82,85],[8,21],[44,56]])})))).apply(this,arguments)}function je(e){var t,r,n,i;return{experimentId:e.id,experimentName:e.name,variantId:null!==(n=null===(t=e.variant)||void 0===t?void 0:t.id)&&void 0!==n?n:void 0,variantName:null!==(i=null===(r=e.variant)||void 0===r?void 0:r.name)&&void 0!==i?i:"control"}}function Fe(e){e.sort((function(e,t){return e==t?0:e.experimentId==t.experimentId?e.variantId==t.variantId?0:void 0==e.variantId?-1:void 0==t.variantId?1:null===(r=e.variantId)||void 0===r?void 0:r.localeCompare(t.variantId):e.experimentId.localeCompare(t.experimentId);var r}))}function Be(e,t,r){var n=t._.json.wireOutputs,i=t._.json.wireArgs,o={},s=0;Object.entries(n).forEach((function(t){var n=x(t,2),a=n[0],u=n[1],c=i[a];if("session"!=a&&"OFF"!=u&&void 0!=u){var l=e._.cache.getFeature(a,c);l?(l.lastRender=be.ssr?"ssr":"csr",s+=1,o[a]={impression:null===u||void 0===u?void 0:u._impressionId,newImpression:r},l.impressionCount+=1,e._.cache.setFeature(a,c,l)):ge.warn("entry is null, ignoring")}})),s>0&&xe.sendBeacon(N(D(e._.args)),{id:t.sessionKeys,impressions:o})}function De(e,t,r,n){if(void 0!=r&&void 0!=n){var i,o=n._.json.wireOutputs,s=n._.json.wireArgs,a=null!==(i=e._.cache.get(ue))&&void 0!==i?i:[],u=new Map(a.map((function(e){return[e.featureName,e]}))),c=new Map;Object.entries(o).forEach((function(e){var t=x(e,2),r=t[0],n=t[1];"session"!=r&&void 0!=s[r]&&c.set(r,{featureName:r,isOn:"OFF"!=n})}));var l=O(c.values()),f=[],d=!0,h=!1,v=void 0;try{for(var p,y=u[Symbol.iterator]();!(d=(p=y.next()).done);d=!0){var g=x(p.value,2),m=g[0],b=g[1];c.has(m)||l.push(b)}}catch(te){h=!0,v=te}finally{try{d||null==y.return||y.return()}finally{if(h)throw v}}var w=!0,S=!1,_=void 0;try{for(var A,R=c[Symbol.iterator]();!(w=(A=R.next()).done);w=!0){var E=x(A.value,2),I=E[0],k=E[1];u.has(I)||f.push(k)}}catch(te){S=!0,_=te}finally{try{w||null==R.return||R.return()}finally{if(S)throw _}}var T,C=function(e,t){return e.featureName.localeCompare(t.featureName)};l.sort(C),f.sort(C);var j,F,B=null!==(T=e._.cache.get(ae))&&void 0!==T?T:[],D=new Map(B.map((function(e){return[null!==(j=e.variantId)&&void 0!==j?j:e.experimentId,e]}))),N=[],P=new Map;if(void 0!=t){var U;F=t,P=new Map(F.map((function(e){return[null!==(U=e.variantId)&&void 0!==U?U:e.experimentId,e]})))}else{P=new Map,Object.entries(o).forEach((function(t){var r=x(t,2),n=r[0],i=r[1],o=s[n];if("session"!=n&&"OFF"!=i&&void 0!=i){var a=e._.cache.getFeature(n,o);if(a&&0==a.impressionCount){var u,c=!0,l=!1,f=void 0;try{for(var d,h=(null!==(u=i._variants)&&void 0!==u?u:[])[Symbol.iterator]();!(c=(d=h.next()).done);c=!0){var v,p,y=d.value,g=null!==(p=null===(v=y.variant)||void 0===v?void 0:v.id)&&void 0!==p?p:y.id;void 0==P.get(g)&&P.set(g,je(y))}}catch(te){l=!0,f=te}finally{try{c||null==h.return||h.return()}finally{if(l)throw f}}}}})),F=O(P.values());var M=!0,J=!1,L=void 0;try{for(var q,K=D[Symbol.iterator]();!(M=(q=K.next()).done);M=!0){var V=x(q.value,2),W=V[0],H=V[1];P.has(W)||F.push(H)}}catch(te){J=!0,L=te}finally{try{M||null==K.return||K.return()}finally{if(J)throw L}}}var G=!0,z=!1,X=void 0;try{for(var Z,$=P[Symbol.iterator]();!(G=(Z=$.next()).done);G=!0){var Q=x(Z.value,2),Y=Q[0],ee=Q[1];D.has(Y)||N.push(ee)}}catch(te){z=!0,X=te}finally{try{G||null==$.return||$.return()}finally{if(z)throw X}}Fe(N),Fe(F),e._.cache.set(ae,F),e._.cache.set(ue,l),be.onUpdateActiveVariants(N),be.onImpression({newVariants:N,allVariants:F,newFeatures:f,allFeatures:l})}}function Ne(e,t,r){var n={},i=!0,o=!1,s=void 0;try{for(var a,u=Object.keys(null!==r&&void 0!==r?r:{})[Symbol.iterator]();!(i=(a=u.next()).done);i=!0){var c=a.value,l=e.toJSON().wireOutputs[c];if("OFF"==l||void 0==l)n[c]=l;else{var f=w({},l,{_impressionId:t});n[c]=f}}}catch(d){o=!0,s=d}finally{try{i||null==u.return||u.return()}finally{if(o)throw s}}return Ee({impressionType:e.toJSON().impressionType,sessionKeys:e.sessionKeys,wireArgs:r,wireOutputs:n})}var Pe=(0,a.createContext)(void 0);function Ue(e,t,r){var n=(0,a.useContext)(Pe);if(void 0==(r=null!==r&&void 0!==r?r:n))throw new Error("No session conext (SessionProvider), and no session passed in");var o=r,s=(0,a.useRef)($(r)),u=null===e||void 0===e?void 0:e._.wireArgs,c=(0,a.useReducer)((function(e){return e+1}),0)[1],l=(0,a.useRef)(),f=(0,a.useRef)({state:"none",impression:s.current}),h=(0,a.useRef)(!0),v=(0,a.useRef)(),p=JSON.stringify(u||void 0),y=(0,a.useRef)(o),g=(0,a.useRef)(p),m=(0,a.useRef)(ee),b=(0,a.useRef)(t),w=!1,S=void 0,_=new Date;if(void 0!=v.current&&o._.cache.outputExpirySeconds&&(S=Je(v.current,o._.cache.outputExpirySeconds)),(!z(y.current._.args,o._.args)||void 0!=S&&S<_||g.current!=p||m.current!=ee||b.current!=t)&&(w=!0,f.current={state:"none",impression:s.current},v.current=void 0,y.current=o,g.current=p,m.current=ee,b.current=t,s.current=$(r)),void 0!=e&&"none"==f.current.state){var A=Z(r,u),x=A.cachedImpression,O=A.metadata;if(void 0!=x&&"none"==f.current.state){w=!0;var R=null!==t&&void 0!==t?t:Y(),E=!1;if(r._.hydrating){var I=!0,k=!0,T=!1,C=void 0;try{for(var j,F=O.values()[Symbol.iterator]();!(k=(j=F.next()).done);k=!0){if(!j.value.hydratable){I=!1;break}}}catch(N){T=!0,C=N}finally{try{k||null==F.return||F.return()}finally{if(T)throw C}}E=!I}De(o,void 0,R,x),f.current=E?{state:"loadingCached",newImpressionId:R,impression:s.current,cachedImpression:x,metadata:O}:{state:"cached",newImpressionId:R,impression:Ne(x,R,u),cachedImpression:x,metadata:O}}}(0,a.useEffect)((function(){function r(){return(r=d(i().mark((function r(){var n,s,a;return i().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(void 0==e){r.next=12;break}return ge.debug(1,"useImpression fetch results effect: request()"),ge.debug(1,"request"),r.next=5,o.requestImpression(e,t);case 5:n=r.sent,s=n.impression,a=n.error,v.current=new Date,f.current={state:"done",impression:s},l.current=a,c();case 12:case"end":return r.stop()}}),r)})))).apply(this,arguments)}ge.debug(1,"useImpression fetch results effect"),void 0!=e&&"none"==f.current.state&&(f.current={state:"loading",impression:s.current},function(){r.apply(this,arguments)}(),c())})),(0,a.useEffect)((function(){if(void 0!=e&&"loadingCached"==f.current.state){var t=f.current.newImpressionId,r=f.current.cachedImpression,n=f.current.metadata;f.current={state:"cached",newImpressionId:t,impression:Ne(r,t,u),cachedImpression:r,metadata:n},c()}})),(0,a.useEffect)((function(){ge.debug(1,"useImpression useEffect: cached"),"cached"==f.current.state&&(Be(o,f.current.cachedImpression,f.current.newImpressionId),f.current={state:"done",impression:f.current.impression})}));var B="none"==f.current.state||"loading"==f.current.state||"loadingCached"==f.current.state;ge.debug(3,"useImpression returning. loading",B),w&&!h.current&&c(),h.current=!1,B&&(r._.loadingImpressionsCount+=1);var D=X(f.current.impression);return{loading:B,impression:f.current.impression,flags:D,error:l.current}}var Me=new Date(864e13);function Je(e,t){return new Date(e.valueOf()+1e3*t)}},1165:function(e,t,r){"use strict";r.d(t,{u:function(){return i}});var n=r(5893);function i(e){var t=e.curRating,r=e.onSetRating;return(0,n.jsx)("div",{className:"rating",children:[1,2,3,4,5].map((function(e){return(0,n.jsx)("span",{onClick:function(){r(e)},children:e<=t?"\u2605":"\u2606"},e)}))})}}}]);